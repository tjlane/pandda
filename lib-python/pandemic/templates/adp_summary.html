{% import 'macros.html' as macros %}
{% import 'styles.html' as styles %}
{% set dn=divnamer(1) %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css"/>
    <script type="text/javascript" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    {{ styles.centred_columns_and_rows() }}

    <style>
      .matrix {
          position: relative;
      }
      .matrix:before, .matrix:after {
          content: "";
          position: absolute;
          top: 0;
          border: 1px solid #000;
          width: 6px;
          height: 100%;
      }
      .matrix:before {
          left: -6px;
          border-right: 0;
      }
      .matrix:after {
          right: -6px;
          border-left: 0;
      }
      .nav-tabs {
          white-space: nowrap; 
          overflow-x: auto;  
          overflow-y: hidden; 
      }
      .nav-tabs > li {
          float: none; 
          display: inline-block;
      }
      .nav-tabs > li.active > a,
      .nav-tabs > li.active > a:hover,
      .nav-tabs > li.active > a:focus {
          color: #000;
          background-color: #ddd !important;
      }
      .tab-borders {
          padding-top: 1px;
          padding-bottom: 1em;
          padding-left: 1em;
          padding-right: 1em;
          border-bottom-left-radius: 1em;
          border-bottom-right-radius: 1em;
          border-left: 1px solid #ddd;
          border-right: 1px solid #ddd;
          border-bottom: 1px solid #ddd;
      }
    </style>
    
    <script type="text/javascript" class="init">
      $(document).ready(function() {
          $(".nav-hover > li > a").on('mouseenter',function(){
              $(this).click();
          });
      });
    </script>  
    
    {{ macros.lightbox_setup(id="lightbox") }}

    <script type="text/javascript" class="init">
      $(document).ready(function() {
          $(".datatable").dataTable();
      });
    </script>  

    {% for plot in json_plots %}
    {{ macros.json_plot(plot=plot) }}

    {% endfor %}

    <title>{{ header }}</title>

  </head>
  <body>

    <div id="lightbox-holder">    
      {{ macros.lightbox_div(id="lightbox") }}
    </div>

    <div class="container">
      <h1>{{ title }}</h1>
      <h2>{{ introduction }}</h2>
      <ul class="nav nav-tabs">
        {% for tab in tabs %}
        <li {% if tab.active -%}class="active"{% endif -%}><a data-toggle="tab" href="#{{ tab.id }}">{{ tab.short_name }}</a></li>
        {%- endfor %}
      </ul>
      <div class="tab-content">
        {% for tab in tabs %}
        <div id="{{ tab.id }}" class="tab-pane fade {% if tab.active -%}in active{% endif -%}">
          <h3>{{ tab.long_name }}</h3>
          <p>{{ tab.description }}</p>

          {% if tab.id == 'overview' %}

          <div id ="overview-tab">

            <div class="row">
              {% for panel in tab.panels %}
              {% set this_div = dn.next() -%}
              <div class="col-centered col-xs-12 col-md-{{ panel.width|default(12) }}">
                {{ macros.basic_panel(div_name=this_div, panel_data=panel) }}
              </div>
              {% endfor %}
            </div>

          </div>

          {% elif tab.id == 'statistics' %}

          <div id="statistics-tab">

            <div class="row">
              {% for panel in tab.panels %}
              {% set this_div = dn.next() -%}
              <div class="col-centered col-xs-12 col-md-{{ panel.width|default(12) }}">
                {{ macros.basic_panel(div_name=this_div, panel_data=panel) }}
              </div>
              {% endfor %}
            </div>

          </div>

          {% elif tab.id == 'levels' %}

          <div id="levels-tab">
            <ul class="nav nav-tabs">
              {% for sub_tab in tab.tabs %}
              <li {% if sub_tab.active -%}class="active"{% endif -%}><a data-toggle="tab" href="#{{ sub_tab.id }}">{{ sub_tab.short_name }}</a></li>
              {%- endfor %}
            </ul>
            <div class="tab-content">
              {% for sub_tab in tab.tabs %}
              <div id="{{ sub_tab.id }}" class="tab-pane fade {% if sub_tab.active -%}in active{% endif -%}">
                <h3>{{ sub_tab.long_name }}</h3>
                <p>{{ sub_tab.description }}</p>
                <div class="row">
                  {% if sub_tab.panels is defined %}
                  {% for panel in sub_tab.panels %}
                  {% set this_div = dn.next() -%}
                  <div class="col-centered col-xs-12 col-md-{{ panel.width|default(12) }}">
                    {{ macros.basic_panel(div_name=this_div, panel_data=panel) }}
                  </div>
                  {% endfor %}
                  {% endif %}

                  {% if sub_tab.chain_tabs is defined %}
                  <div class="col-centered col-xs-12 col-padded-y">
                    <h4>Chain-by-Chain Summaries</h4>
                    {{ macros.basic_tab_set(sub_tab.chain_tabs, nav_classes=['nav-hover']) }}
                  </div>
                  {% endif %}
                
                  {% if sub_tab.group_tabs is defined %}
                  <div class="col-centered col-xs-12 col-padded-y">
                    <h4>Group-by-Group Summaries</h4>
                    {{ macros.basic_tab_set(sub_tab.group_tabs, nav_classes=['nav-hover']) }}
                  </div>
                  {% endif %}

                </div>
              </div>
              {% endfor %}
            </div>
          </div>

          {% elif tab.id == 'settings' %}

          <div id ="settings-tab">
            <div class="row">
              {% for panel in tab.panels %}
              {% set this_div = dn.next() -%}
              <div class="col-centered col-xs-12 col-md-{{ panel.width|default(12) }}">
                {{ macros.basic_panel(div_name=this_div, panel_data=panel) }}
              </div>
              {% endfor %}
            </div>
          </div>

          {% endif %}

        </div> 
        {% endfor %}
      </div>
    </div>
  </body>
</html>

